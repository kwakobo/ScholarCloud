<meta charset="utf-8" />
<html>
    <head>
        <title>QUnit Test Suite</title>
        <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="http://code.jquery.com/ui/1.10.4/jquery-ui.min.js"></script>
        <script src="bower_components/qunit/qunit/qunit.js"></script>
        <link rel="stylesheet" href="bower_components/qunit/qunit/qunit.css">
        <script src="blanket.min.js"></script>

        <script type="text/javascript" src="./../../src/sortfunctions.js" data-cover></script>
        <script type="text/javascript" src="canvasTests.js" data-cover></script>
        <script type="text/javascript" src="../../src/include/authorList.js" data-cover></script>
        <script type="text/javascript" src="autocomplete.js" data-cover></script>

    </head>
    <body>
        <input id="project-search" hidden="hidden" text="Sia">
        <button id="project-button" hidden="hidden"></button>


        <div id="qunit"></div>
        <div id="qunit-fixture"></div>
    	<script>
    		/* 
    			Quinn & Taylor's Whitebox Tests
    		*/
    		//Correct Author, checks if func returns correct author
    		QUnit.test("checkAuthor", function( assert ) {
    			//run our function on author, compare to expectedResult
    			function authorTest(author, expectedResult) {
    				assert.deepEqual(parse_authors(author), expectedResult); 
    			}
    			authorTest("Shakes", ["Shakes"]); 
                authorTest("Shakes;  Halfond", ["Shakes", "Halfond"]);
                authorTest("Shakes;  Halfond;  Shakes", ["Shakes", "Halfond", "Shakes"]);
    		});
    		//Correct Link, checks if func researches correct link
    		QUnit.test("checkLink", function( assert ) {
    			//run our function on link, compare to expectedResult
    			function linkTest(link, expectedResult) {
    				assert.equal(open_urlTest(link), expectedResult); 
    			}
    			linkTest("Shakes", "www.Shakes.com"); 
    		});
            //Check if canvas download link is correct
            QUnit.test("isCanvasLinkRight", function( assert ) {
                function canvasTest(expectedResult) {
                    var answer = dlCanvasTest().split(',');
                    assert.equal(answer[0], expectedResult); 
                }
                canvasTest("data:application/octet-stream;headers=Content-Disposition%3A%20attachment%3B%20filename=canvas.png;base64");
            });
            //Check if returns correct string corresponding to highlights 
            QUnit.test("checkHighlightTest", function( assert ) {
                function highlightTest(abstractArray, chosenWord, expectedResult) {
                    assert.deepEqual(checkHighlight(abstractArray, chosenWord), expectedResult);
                }
                highlightTest(["Shakes","Yo"], "Shakes", ["<span style=color:#FFFF00>Shakes</span> ","Yo"]);
                highlightTest(["Shakes","Yo"], "Me", ["Shakes","Yo"]); 
            });
            //check if progress bar is implemented correctly 
            QUnit.test("checkProgressBar", function( assert ) {
                function progressTest(width, expectedResult) {
                    assert.equal(getProgressWidth(width),expectedResult);
                } 
                progressTest(0,1);
                progressTest(99,100);
            });

            /*
            *Begin sorting function tests by Jeffrey/Bryce
            */
            QUnit.test("testSortByTitleAscending", function(assert){
                var data = [{"title":"b"},{"title":"c"},{"title":"a"}];
                var sortedData = [{"title":"a"},{"title":"b"},{"title":"c"}];

                assert.deepEqual(sort(data, "title", sortEnum.ASCENDING), sortedData);
            })

            QUnit.test("testSortByTitleDescending", function(assert){
                var data = [{"title":"b"},{"title":"c"},{"title":"a"}];
                var sortedData = [{"title":"c"},{"title":"b"},{"title":"a"}];

                assert.deepEqual(sort(data, "title", sortEnum.DESCENDING), sortedData);
            })

            QUnit.test("testSortByAuthorAscending", function(assert){
                var data = [{"author":"b"},{"author":"c"},{"author":"a"}];
                var sortedData = [{"author":"a"},{"author":"b"},{"author":"c"}];

                assert.deepEqual(sort(data, "author", sortEnum.ASCENDING), sortedData);
            })

            QUnit.test("testSortByAuthorDescending", function(assert){
                var data = [{"author":"b"},{"author":"c"},{"author":"a"}];
                var sortedData = [{"author":"c"},{"author":"b"},{"author":"a"}];

                assert.deepEqual(sort(data, "author", sortEnum.DESCENDING), sortedData);
            })

            QUnit.test("testSortByFrequencyAscending", function(assert){
                var data = [{"frequency":2},{"frequency":3},{"frequency":1}];
                var sortedData = [{"frequency":1},{"frequency":2},{"frequency":3}];

                assert.deepEqual(sort(data, "frequency", sortEnum.ASCENDING), sortedData);
            })

            QUnit.test("testSortByFrequencyDescending", function(assert){
                var data = [{"frequency":2},{"frequency":3},{"frequency":1}];
                var sortedData = [{"frequency":3},{"frequency":2},{"frequency":1}];

                assert.deepEqual(sort(data, "frequency", sortEnum.DESCENDING), sortedData);
            })

            /*
            *End sorting function tests
            */

            /*
            *begin autocomplete.js / previous searches tests
            */

            QUnit.test("testAddToPreviousSearches", function(assert){
                localStorage.clear(); //clear localstorage for test cases
                window.previousSearches = [];
                addToPreviousSearches("William Halfond");
                assert.deepEqual(JSON.parse(localStorage.getItem('previousSearches')), ["William Halfond"]);
            })

            QUnit.test("testAddToPreviousSearchesTwice", function(assert){
                localStorage.clear(); // clear localstorage for test cases
                window.previousSearches = [];
                addToPreviousSearches("William Halfond");
                addToPreviousSearches("Bryce Roski");
                assert.deepEqual(JSON.parse(localStorage.getItem('previousSearches')), ["William Halfond", "Bryce Roski"]);
            })

            QUnit.test("testAddRemoveCheckbox", function(assert) {
                assert.equal(true, true);
            })

            /*
            *end autocomplete.js / previous searches tests
            */
    	</script>
	</body>
</html>